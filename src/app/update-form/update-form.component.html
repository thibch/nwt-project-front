<h2 mat-dialog-title>Mise à jour des informations du compte</h2>

<mat-dialog-content>
  <p *ngIf="error">Pseudo ou mail déjà utilisé !</p>

  <form [formGroup]="updateForm" novalidate>
    <table cellspacing="0" class="full-width">
      <tr>
        <td>
          <mat-form-field [class.mgb15]="updateForm.get('firstname')?.dirty && updateForm.get('firstname')?.invalid"
                          class="full-width">
            <input [ngModel]="user.firstname" formControlName="firstname" matInput minlength="2" name="firstname"
                   placeholder="Prénom" required/>
            <mat-error
              *ngIf="updateForm.get('firstname')?.dirty && updateForm.get('firstname')?.hasError('required')">
              Le champ prénom est <strong>requis.</strong>
            </mat-error>
            <mat-error
              *ngIf="updateForm.get('firstname')?.dirty && updateForm.get('firstname')?.hasError('minlength')">
              Le champ prénom doit contenir au minimum <strong>2 charactères.</strong>
            </mat-error>
          </mat-form-field>
        </td>
        <td class="align-right">
          <mat-form-field [class.mgb15]="updateForm.get('lastname')?.dirty && updateForm.get('lastname')?.invalid"
                          class="full-width">
            <input [ngModel]="user.lastname" formControlName="lastname" matInput minlength="2" name="lastname"
                   placeholder="Nom" required/>
            <mat-error
              *ngIf="updateForm.get('lastname')?.dirty && updateForm.get('lastname')?.hasError('required')">
              Le champ nom est <strong>requis.</strong>
            </mat-error>
            <mat-error
              *ngIf="updateForm.get('lastname')?.dirty && updateForm.get('lastname')?.hasError('minlength')">
              Le champ nom doit contenir au minimum <strong>2 charactères.</strong>
            </mat-error>
          </mat-form-field>
        </td>
      </tr>
    </table>
    <p>
      <mat-form-field [class.mgb15]="updateForm.get('username')?.dirty && updateForm.get('username')?.invalid"
                      class="full-width">
        <input [ngModel]="user.username" formControlName="username" matInput minlength="2" name="username"
               placeholder="Pseudo"/>

        <mat-error *ngIf="updateForm.get('username')?.dirty && updateForm.get('username')?.hasError('minlength')">
          Le champ pseudo doit contenir au minimum <strong>2 charactères.</strong>
        </mat-error>
      </mat-form-field>
    </p>
    <p>
      <mat-form-field [class.mgb15]="updateForm.get('email')?.dirty && updateForm.get('email')?.invalid"
                      class="full-width">
        <input [ngModel]="user.email" formControlName="email" matInput minlength="8" name="email" placeholder="Mail"
               type="email"/>

        <mat-error *ngIf="updateForm.get('email')?.dirty && updateForm.get('email')?.hasError('minlength')">
          Le champ mail doit contenir au minimum <strong>8 charactères.</strong>
        </mat-error>
        <mat-error *ngIf="updateForm.get('email')?.dirty && updateForm.get('email')?.hasError('regex')">
          Le champ mail doit respecter la syntaxe <strong> text@domaine.extension.</strong>
        </mat-error>
      </mat-form-field>
    </p>

    <p>
      <mat-form-field [class.mgb15]="updateForm.get('photo')?.dirty && updateForm.get('photo')?.invalid"
                      class="full-width">
        <input [ngModel]="user.photo" formControlName="photo" matInput name="photo" placeholder="Lien vers un avatar"/>
      </mat-form-field>
    </p>
    <p>
      <mat-form-field [class.mgb15]="updateForm.get('birthDate')?.dirty && updateForm.get('birthDate')?.invalid"
                      class="full-width">
        <input [ngModel]="user.birthDate" formControlName="birthDate" matInput name="birthDate"
               placeholder="Date de naissance" required type="date"/>
        <mat-error
          *ngIf="updateForm.get('birthDate')?.dirty && updateForm.get('birthDate')?.hasError('required')">
          Le champ date de naissance est <strong>requis.</strong>
        </mat-error>
      </mat-form-field>
    </p>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button (click)="redirectBack()" mat-button type="button">Annuler</button>
  <button (click)="update(updateForm.value)" [disabled]="updateForm.invalid" mat-button type="submit">Mise à jour du
    compte
  </button>
</mat-dialog-actions>
